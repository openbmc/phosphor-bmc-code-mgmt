{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "74ba8d23_787ea59d",
        "filename": "fw-update/common/include/software.hpp",
        "patchSetId": 54
      },
      "lineNbr": 27,
      "author": {
        "id": 1001758
      },
      "writtenOn": "2024-11-27T20:52:10Z",
      "side": 1,
      "message": "Software Activation is the first interface you create as part of StartUpdate in a sync order. at that time you don\u0027t know the version yet, as image hasn\u0027t been parsed yet, so you cannot create the Version and other interfaces. So, i would suggest to create a composite for Version and associations only and create activation interface early. Activation interface is the one you need to change in case your image parsing and verification logic fails. Please refer to sequence diagram in design.",
      "revId": "fe65f0507f742b797dab596536655c7164b8625b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ee9a2e0d_aaf3462f",
        "filename": "fw-update/common/include/software.hpp",
        "patchSetId": 54
      },
      "lineNbr": 27,
      "author": {
        "id": 1001712
      },
      "writtenOn": "2024-11-28T16:26:36Z",
      "side": 1,
      "message": "\u003e Software Activation is the first interface you create as part of StartUpdate in a sync order. at that time you don\u0027t know the version yet, as image hasn\u0027t been parsed yet, so you cannot create the Version and other interfaces.\n\nYes, the activation interface on the object path is probably needed for the bmcweb, and we should not create the other interfaces without having the property values.\n\n\u003e So, i would suggest to create a composite for Version and associations only\n\nFor now i\u0027m representing it as unique_ptr on the software object, so we do not have to create another object here for these dbus interfaces.\nWhen \u0027Software\u0027 class is initialized, these can be nullptr, and then later be\npopulated when the information is available.\n\nThe latest patchset should set the activation status synchronously during the dbus call.",
      "parentUuid": "74ba8d23_787ea59d",
      "revId": "fe65f0507f742b797dab596536655c7164b8625b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e6561c98_490e11b1",
        "filename": "fw-update/common/include/software.hpp",
        "patchSetId": 54
      },
      "lineNbr": 56,
      "author": {
        "id": 1001758
      },
      "writtenOn": "2024-11-27T20:52:10Z",
      "side": 1,
      "message": "I would suggest its better to hide this in common layer by creating it for ActivationStatus \u003d Activating and deleting it when ActivationStatus \u003d Active. You already have API for setActivation, so its better to do it internally as part of that?",
      "revId": "fe65f0507f742b797dab596536655c7164b8625b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "840f6909_8bdf85f1",
        "filename": "fw-update/common/include/software.hpp",
        "patchSetId": 54
      },
      "lineNbr": 56,
      "author": {
        "id": 1001712
      },
      "writtenOn": "2024-11-28T16:41:35Z",
      "side": 1,
      "message": "It is tempting...\n\nThere may be devices who do not need this \u0027ActivationBlocksTransition\u0027 interface. Those devices can make a state transition independent of any firmware update.\nFor example devices with A/B schema.\n\nSo i would like to avoid coupling the two in the common code.\nCurrently they are still coupled but there could be a different requirement in the future.\n\nAlso, it is easier for me to see that the code in device.cpp follows the design, when the\n`setActivationBlocksTransition` is done as a separate function.\nOne can go step by step through the design and have roughly a 1:1 mapping between\nstatements in the functions in device.cpp and the steps outlined in the design.\n\nKeeping this comment as unresolved here if you want to discuss further.",
      "parentUuid": "e6561c98_490e11b1",
      "revId": "fe65f0507f742b797dab596536655c7164b8625b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "591fd681_e9cffa7f",
        "filename": "fw-update/common/src/software.cpp",
        "patchSetId": 54
      },
      "lineNbr": 40,
      "author": {
        "id": 1001758
      },
      "writtenOn": "2024-11-27T20:08:59Z",
      "side": 1,
      "message": "Please use the documented associations from \n\nhttps://github.com/openbmc/docs/blob/master/designs/code-update.md#association\n\nhttps://github.com/openbmc/phosphor-dbus-interfaces/blob/master/yaml/xyz/openbmc_project/Software/Version.interface.yaml#L47\n\nActivation in Progress : activating association.\nSW Running: running association.\n\nPlease let me know if you have any questions.",
      "revId": "fe65f0507f742b797dab596536655c7164b8625b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4ff869c6_011f430d",
        "filename": "fw-update/common/src/software.cpp",
        "patchSetId": 54
      },
      "lineNbr": 40,
      "author": {
        "id": 1001712
      },
      "writtenOn": "2024-11-28T16:26:36Z",
      "side": 1,
      "message": "sorry, i did not read through that section in the document.\nThe mermaid diagram already made so much sense that i though i would get by with just looking at that.\n\nThe newest revision should match what you wrote in that paragraph about the 2 different associations. Also got a better understanding now of what the alternative flow at the end of the diagram is used for.\n\nSo we either set the running or the activating association, but not both at the same time. Depending on if the apply time is immediate.",
      "parentUuid": "591fd681_e9cffa7f",
      "revId": "fe65f0507f742b797dab596536655c7164b8625b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}